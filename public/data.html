<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sleep Diary</title>
    <meta name="description" content="双極性障害の人が毎日の睡眠や気分の状態を記録するための日記。">
    <link rel ="stylesheet" href="ress.css">  <!--リセットcss-->
    <link rel="stylesheet" href="styles.css">
    <!--ogp-->
    <meta property="og:title" content="Sleep Diary">
    <meta property="og:type" content="website">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <meta name="og:description" content="双極性障害の人が毎日の睡眠や気分の状態を記録するための日記。">
    <!--favicon-->
    <link rel="icon" type="image/png" href="blue.png">
    <!--font-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kiwi+Maru&display=swap" rel="stylesheet">
    <!--chart.js-->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.8.0/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@1.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    </head>
    <body>
      <header>
        <h1>Sleep Diary for me</h1>
        <nav>
            <ul>
              <li><a href="graph.html">グラフ</a></li>
              <li><a href="data.html">データ</a></li>
              <li><a href="index.html">TOP</a></li>
            </ul>
          </nav>
      </header>
      <main>

        <h2>データ一覧</h2>
        <table id="dataTable">
          <thead>
            <tr>
              <th style="width:10%;">日付</th>
              <th style="width:5%;">睡眠時間</th>
              <th style="width:5%;">気分スコア</th>
              <th style="width:80%;">日記</th>
            </tr>
          </thead>
          <tbody>
            <!-- データ行はここに追加されます -->
          </tbody>
        </table>
      

        <script>
            //YYY-MM-DD
            const base_url = 'https://sleep-diary-5uzz.onrender.com';

          // データを取得してテーブルに表示
          window.onload = function() {
            fetch(`${base_url}/getData`)
              .then(response => response.json())
              .then(data => {
                const tableBody = document.getElementById('dataTable').getElementsByTagName('tbody')[0];
               
                data.forEach(row => {
                  const newRow = tableBody.insertRow();
                  const dateCell = newRow.insertCell(0);
                  const valueCell = newRow.insertCell(1);
                  const moodCell = newRow.insertCell(2);
                  const diaryCell = newRow.insertCell(3);
                  
                  // 日付のフォーマットを 'YYYY-MM-DD' に変更
                    const utcDate = new Date(row.date);
                    const jstDate= new Date(utcDate.getTime() + 9 * 60 * 60 * 1000);//UTCから９時間加算
                    const formattedDate = jstDate.toISOString().split('T')[0];  // 'YYYY-MM-DD'形式
                    console.log(jstDate.toLocaleDateString()); // ローカルタイムでの表示
                  
                    dateCell.textContent = formattedDate;  // 日付を設定
                    valueCell.textContent = row.value;  // 数値を設定
                    moodCell.textContent = row.mood;
                    diaryCell.textContent = row.diary;
                });
              })
              .catch(error => {
                console.error('データ取得エラー:', error);
              });
          };
        </script>
       
      </main>
      <footer>
      </footer>
    </body>
    </html>
    
